{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{BrowserRouter,Switch,Route}from'react-router-dom';import Axios from'axios';import Header from'./components/layout/Header';import Home from'./components/pages/Home.js';import Login from'./components/auth/Login.js';import Register from'./components/auth/Register.js';import UserContext from'./context/UserContext';import'./App.css';function App(){var _useState=useState({token:undefined,user:undefined}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];useEffect(function(){var checkLoggedIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,tokenRes,userRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=localStorage.getItem(\"auth-token\");if(token===null){localStorage.setItem('auth-token','');token='';}_context.next=4;return Axios.post('http://localhost:5000/api/users/tokenIsValid',null,{headers:{'x-auth-token':token}});case 4:tokenRes=_context.sent;if(!tokenRes.data){_context.next=10;break;}_context.next=8;return Axios.get('http://localhost:5000/api/users/',{headers:{'x-auth-token':token}});case 8:userRes=_context.sent;setUserData({token:token,user:userRes.data});case 10:case\"end\":return _context.stop();}}},_callee);}));return function checkLoggedIn(){return _ref.apply(this,arguments);};}();checkLoggedIn();},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(BrowserRouter,null,/*#__PURE__*/React.createElement(UserContext.Provider,{value:{userData:userData,setUserData:setUserData}},/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\",component:Home}),/*#__PURE__*/React.createElement(Route,{path:\"/login\",component:Login}),/*#__PURE__*/React.createElement(Route,{path:\"/register\",component:Register}))))));}export default App;","map":{"version":3,"sources":["/Users/nicholasmcconnell/code/todo/client/src/App.js"],"names":["React","useState","useEffect","BrowserRouter","Switch","Route","Axios","Header","Home","Login","Register","UserContext","App","token","undefined","user","userData","setUserData","checkLoggedIn","localStorage","getItem","setItem","post","headers","tokenRes","data","get","userRes"],"mappings":"6dAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,aAAT,CAAwBC,MAAxB,CAAgCC,KAAhC,KAA6C,kBAA7C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,4BAAnB,CACA,MAAOC,CAAAA,IAAP,KAAiB,4BAAjB,CACA,MAAOC,CAAAA,KAAP,KAAkB,4BAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,+BAArB,CACA,MAAOC,CAAAA,WAAP,KAAwB,uBAAxB,CAEA,MAAO,WAAP,CAEA,QAASC,CAAAA,GAAT,EAAe,eACmBX,QAAQ,CAAC,CACvCY,KAAK,CAAEC,SADgC,CAEvCC,IAAI,CAAED,SAFiC,CAAD,CAD3B,wCACNE,QADM,eACIC,WADJ,eAMbf,SAAS,CAAC,UAAM,CACd,GAAMgB,CAAAA,aAAa,0FAAG,8JAChBL,KADgB,CACRM,YAAY,CAACC,OAAb,CAAqB,YAArB,CADQ,CAEpB,GAAIP,KAAK,GAAK,IAAd,CAAoB,CAClBM,YAAY,CAACE,OAAb,CAAqB,YAArB,CAAmC,EAAnC,EACAR,KAAK,CAAG,EAAR,CACD,CALmB,sBAOGP,CAAAA,KAAK,CAACgB,IAAN,CACrB,8CADqB,CAErB,IAFqB,CAGrB,CAAEC,OAAO,CAAE,CAAE,eAAgBV,KAAlB,CAAX,CAHqB,CAPH,QAOdW,QAPc,mBAYhBA,QAAQ,CAACC,IAZO,gDAaInB,CAAAA,KAAK,CAACoB,GAAN,CAAU,kCAAV,CAA8C,CAClEH,OAAO,CAAE,CAAE,eAAgBV,KAAlB,CADyD,CAA9C,CAbJ,QAaZc,OAbY,eAgBlBV,WAAW,CAAC,CACVJ,KAAK,CAALA,KADU,CAEVE,IAAI,CAAEY,OAAO,CAACF,IAFJ,CAAD,CAAX,CAhBkB,uDAAH,kBAAbP,CAAAA,aAAa,0CAAnB,CAsBAA,aAAa,GACd,CAxBQ,CAwBN,EAxBM,CAAT,CA0BA,mBACE,qDACE,oBAAC,aAAD,mBACE,oBAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEF,QAAQ,CAARA,QAAF,CAAYC,WAAW,CAAXA,WAAZ,CAA7B,eACE,oBAAC,MAAD,MADF,cAEE,2BAAK,SAAS,CAAC,WAAf,eACE,oBAAC,MAAD,mBACE,oBAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,GAAlB,CAAsB,SAAS,CAAET,IAAjC,EADF,cAEE,oBAAC,KAAD,EAAO,IAAI,CAAC,QAAZ,CAAqB,SAAS,CAAEC,KAAhC,EAFF,cAGE,oBAAC,KAAD,EAAO,IAAI,CAAC,WAAZ,CAAwB,SAAS,CAAEC,QAAnC,EAHF,CADF,CAFF,CADF,CADF,CADF,CAgBD,CAED,cAAeE,CAAAA,GAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter, Switch, Route } from 'react-router-dom';\nimport Axios from 'axios';\nimport Header from './components/layout/Header'\nimport Home from './components/pages/Home.js';\nimport Login from './components/auth/Login.js';\nimport Register from './components/auth/Register.js';\nimport UserContext from './context/UserContext';\n\nimport './App.css';\n\nfunction App() {\n  const [userData, setUserData] = useState({\n    token: undefined,\n    user: undefined\n  })\n\n  useEffect(() => {\n    const checkLoggedIn = async () => {\n      let token = localStorage.getItem(\"auth-token\");\n      if (token === null) {\n        localStorage.setItem('auth-token', '');\n        token = '';\n      }\n\n      const tokenRes = await Axios.post(\n        'http://localhost:5000/api/users/tokenIsValid',\n        null,\n        { headers: { 'x-auth-token': token } }\n      );\n      if (tokenRes.data) {\n        const userRes = await Axios.get('http://localhost:5000/api/users/', {\n          headers: { 'x-auth-token': token }\n        });\n        setUserData({\n          token,\n          user: userRes.data\n        })\n      }\n    };\n    checkLoggedIn();\n  }, [])\n\n  return (\n    <>\n      <BrowserRouter>\n        <UserContext.Provider value={{ userData, setUserData }}>\n          <Header />\n          <div className='container'>\n            <Switch>\n              <Route exact path='/' component={Home} />\n              <Route path='/login' component={Login} />\n              <Route path='/register' component={Register} />\n            </Switch>\n          </div>\n        </UserContext.Provider>\n      </BrowserRouter>\n    </>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}