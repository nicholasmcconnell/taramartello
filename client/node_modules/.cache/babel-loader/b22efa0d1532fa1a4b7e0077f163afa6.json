{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect}from'react';import{useHistory,Link}from'react-router-dom';import API from'../../utils/todoAPI';import Axios from'axios';import UserContext from'../../context/UserContext';import Card from'../layout/Card';import ErrorNotice from'../misc/ErrorNotice';export default function GetTodos(){var _useContext=useContext(UserContext),userData=_useContext.userData;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),todoList=_useState2[0],setTodoList=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];// const [toggle, setToggle] = useEffect('');\nvar history=useHistory();localStorage.setItem('lastVisited','gettodos');useEffect(function(){if(!userData.user){history.push('/login');}});useEffect(function(){API.getTodos(userData.token).then(function(res){setTodoList(res.data);}).catch(function(err){return err.response.data.msg&&setError(err.response.data.msg)&&console.log(err);});},[]);var getTodos=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return API.getTodos(userData.token).then(function(res){return setTodoList(res.data);}).catch(function(err){return err.response.data.msg&&setError(err.response.data.msg);});case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 8:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);}));return function getTodos(){return _ref.apply(this,arguments);};}();var deleteTodos=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return API.deleteTodos(userData.token,id).then(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return API.getTodos(userData.token).then(function(res){setTodoList(res.data);}).catch(function(err){if(todoList.length>=1){setTodoList([]);err.response.data.msg&&setError(err.response.data.msg);}});case 2:case\"end\":return _context2.stop();}}},_callee2);}))).catch(function(err){return err.response.data.msg&&setError(err.response.data.msg);});case 3:_context3.next=8;break;case 5:_context3.prev=5;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,5]]);}));return function deleteTodos(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Get Todo's\"),error&&/*#__PURE__*/React.createElement(ErrorNotice,{message:error,clearError:function clearError(){return setError(undefined);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"card-container\"},todoList.length?todoList.map(function(todo){return/*#__PURE__*/React.createElement(Card,{id:todo._id,todoList:todo,key:todo._id,deleteTodos:deleteTodos,getTodos:getTodos});}):/*#__PURE__*/React.createElement(\"p\",null)),/*#__PURE__*/React.createElement(Link,{to:\"/\"},/*#__PURE__*/React.createElement(\"button\",{className:\"type-button\",value:\"Home\"},\"Home\"))));}","map":{"version":3,"sources":["/Users/nicholasmcconnell/code/todo/client/src/components/todo/GetTodos.js"],"names":["React","useContext","useState","useEffect","useHistory","Link","API","Axios","UserContext","Card","ErrorNotice","GetTodos","userData","todoList","setTodoList","error","setError","history","localStorage","setItem","user","push","getTodos","token","then","res","data","catch","err","response","msg","console","log","deleteTodos","id","length","undefined","map","todo","_id"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react'\nimport { useHistory, Link } from 'react-router-dom';\nimport API from '../../utils/todoAPI';\nimport Axios from 'axios';\nimport UserContext from '../../context/UserContext';\nimport Card from '../layout/Card'\nimport ErrorNotice from '../misc/ErrorNotice';\n\nexport default function GetTodos() {\n    const { userData } = useContext(UserContext);\n    const [todoList, setTodoList] = useState([]);\n    const [error, setError] = useState();\n    // const [toggle, setToggle] = useEffect('');\n\n\n    const history = useHistory();\n\n    localStorage.setItem('lastVisited', 'gettodos');\n\n    useEffect(() => {\n        if (!userData.user) {\n            history.push('/login')\n        }\n    });\n\n    useEffect(() => {\n        API.getTodos(userData.token)\n            .then(res => {\n                setTodoList(res.data)\n            })\n            .catch(err =>\n                (err.response.data.msg && setError(err.response.data.msg) && console.log(err))\n            )\n    }, [])\n\n    const getTodos = async () => {\n        try {\n            await API.getTodos(userData.token)\n                .then(res =>\n                    setTodoList(res.data)\n                )\n                .catch(err =>\n                    (err.response.data.msg && setError(err.response.data.msg))\n                )\n        } catch (err) {\n            console.log(err)\n        }\n    }\n\n\n    const deleteTodos = async (id) => {\n        try {\n            await API.deleteTodos(userData.token, id)\n                .then(async () => {\n                    await API.getTodos(userData.token)\n                        .then(res => {\n                            setTodoList(res.data)\n                        })\n                        .catch(err => {\n                            if (todoList.length >= 1) {\n                                setTodoList([]);\n                                (err.response.data.msg && setError(err.response.data.msg))\n                            }\n                        })\n                })\n                .catch(err =>\n                    (err.response.data.msg && setError(err.response.data.msg))\n                )\n        } catch (err) {\n            console.log(err)\n        }\n    }\n\n    return (\n        <div className='page'>\n            <div className='container'>\n                <h2>Get Todo's</h2>\n                {error && (\n                    <ErrorNotice message={error} clearError={() => setError(undefined)} />\n                )}\n\n                <div className='card-container'>\n                    {todoList.length ? todoList.map(todo =>\n                        <Card\n                            id={todo._id}\n                            todoList={todo}\n                            key={todo._id}\n                            deleteTodos={deleteTodos}\n                            getTodos={getTodos}\n                        />\n\n                    ) : <p></p>}\n                </div>\n                <Link to='/'>\n                    <button className='type-button' value='Home'>Home</button>\n                </Link>\n            </div>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}