{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from'react';import{useHistory}from'react-router-dom';import UserContext from'../../context/UserContext';import Axios from'axios';import ErrorNotice from'../misc/ErrorNotice';export default function Login(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useContext=useContext(UserContext),userData=_useContext.userData,setUserData=_useContext.setUserData;var history=useHistory();useEffect(function(){var lastVisited=localStorage.getItem('lastVisited');if(userData.user){history.push(lastVisited);}});var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var loginUser,loginRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;loginUser={email:email,password:password};_context.next=5;return Axios.post('/api/users/login',loginUser);case 5:loginRes=_context.sent;setUserData({token:loginRes.data.token,user:loginRes.data.user});localStorage.setItem('auth-token',loginRes.data.token);history.push('/');_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);_context.t0.response.data.msg&&setError(_context.t0.response.data.msg);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function submit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Login\"),error&&/*#__PURE__*/React.createElement(ErrorNotice,{message:error,clearError:function clearError(){return setError(undefined);}}),/*#__PURE__*/React.createElement(\"form\",{className:\"form\",onSubmit:submit},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"login-email\"},\"Email\"),/*#__PURE__*/React.createElement(\"input\",{id:\"login-email\",type:\"email\",onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"login-password\"},\"Password\"),/*#__PURE__*/React.createElement(\"input\",{id:\"login-password\",type:\"password\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Log in\"}))));}","map":{"version":3,"sources":["/Users/nicholasmcconnell/code/todo/client/src/components/auth/Login.js"],"names":["React","useState","useContext","useEffect","useHistory","UserContext","Axios","ErrorNotice","Login","email","setEmail","password","setPassword","error","setError","userData","setUserData","history","lastVisited","localStorage","getItem","user","push","submit","e","preventDefault","loginUser","post","loginRes","token","data","setItem","response","msg","undefined","target","value"],"mappings":"6dAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,UAA1B,CAAsCC,SAAtC,KAAuD,OAAvD,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,WAAP,KAAwB,qBAAxB,CAEA,cAAe,SAASC,CAAAA,KAAT,EAAiB,eACFP,QAAQ,EADN,wCACrBQ,KADqB,eACdC,QADc,8BAEIT,QAAQ,EAFZ,yCAErBU,QAFqB,eAEXC,WAFW,8BAGFX,QAAQ,EAHN,yCAGrBY,KAHqB,eAGdC,QAHc,+BAKMZ,UAAU,CAACG,WAAD,CALhB,CAKpBU,QALoB,aAKpBA,QALoB,CAKVC,WALU,aAKVA,WALU,CAM5B,GAAMC,CAAAA,OAAO,CAAGb,UAAU,EAA1B,CAEAD,SAAS,CAAC,UAAM,CACZ,GAAMe,CAAAA,WAAW,CAAGC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAApB,CACA,GAAIL,QAAQ,CAACM,IAAb,CAAmB,CACfJ,OAAO,CAACK,IAAR,CAAaJ,WAAb,EACH,CACJ,CALQ,CAAT,CAOA,GAAMK,CAAAA,MAAM,0FAAG,iBAAOC,CAAP,yIACXA,CAAC,CAACC,cAAF,GADW,gBAGDC,SAHC,CAGW,CAAEjB,KAAK,CAALA,KAAF,CAASE,QAAQ,CAARA,QAAT,CAHX,uBAIgBL,CAAAA,KAAK,CAACqB,IAAN,CACnB,kBADmB,CAEnBD,SAFmB,CAJhB,QAIDE,QAJC,eASPZ,WAAW,CAAC,CACRa,KAAK,CAAED,QAAQ,CAACE,IAAT,CAAcD,KADb,CAERR,IAAI,CAAEO,QAAQ,CAACE,IAAT,CAAcT,IAFZ,CAAD,CAAX,CAKAF,YAAY,CAACY,OAAb,CAAqB,YAArB,CAAmCH,QAAQ,CAACE,IAAT,CAAcD,KAAjD,EACAZ,OAAO,CAACK,IAAR,CAAa,GAAb,EAfO,iFAiBN,YAAIU,QAAJ,CAAaF,IAAb,CAAkBG,GAAlB,EAAyBnB,QAAQ,CAAC,YAAIkB,QAAJ,CAAaF,IAAb,CAAkBG,GAAnB,CAAlC,CAjBO,qEAAH,kBAANV,CAAAA,MAAM,4CAAZ,CAsBA,mBACI,2BAAK,SAAS,CAAC,MAAf,eACI,2BAAK,SAAS,CAAC,WAAf,eACI,sCADJ,CAEKV,KAAK,eACF,oBAAC,WAAD,EAAa,OAAO,CAAEA,KAAtB,CAA6B,UAAU,CAAE,4BAAMC,CAAAA,QAAQ,CAACoB,SAAD,CAAd,EAAzC,EAHR,cAKI,4BAAM,SAAS,CAAC,MAAhB,CAAuB,QAAQ,CAAEX,MAAjC,eACI,6BAAO,OAAO,CAAC,aAAf,UADJ,cAEI,6BACI,EAAE,CAAC,aADP,CAEI,IAAI,CAAC,OAFT,CAGI,QAAQ,CAAE,kBAAAC,CAAC,QAAId,CAAAA,QAAQ,CAACc,CAAC,CAACW,MAAF,CAASC,KAAV,CAAZ,EAHf,EAFJ,cAQI,6BAAO,OAAO,CAAC,gBAAf,aARJ,cASI,6BACI,EAAE,CAAC,gBADP,CAEI,IAAI,CAAC,UAFT,CAGI,QAAQ,CAAE,kBAAAZ,CAAC,QAAIZ,CAAAA,WAAW,CAACY,CAAC,CAACW,MAAF,CAASC,KAAV,CAAf,EAHf,EATJ,cAeI,6BAAO,IAAI,CAAC,QAAZ,CAAqB,KAAK,CAAC,QAA3B,EAfJ,CALJ,CADJ,CADJ,CA4BH","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport UserContext from '../../context/UserContext';\nimport Axios from 'axios';\nimport ErrorNotice from '../misc/ErrorNotice';\n\nexport default function Login() {\n    const [email, setEmail] = useState();\n    const [password, setPassword] = useState();\n    const [error, setError] = useState();\n\n    const { userData, setUserData } = useContext(UserContext);\n    const history = useHistory();\n\n    useEffect(() => {\n        const lastVisited = localStorage.getItem('lastVisited')\n        if (userData.user) {\n            history.push(lastVisited)\n        }\n    });\n\n    const submit = async (e) => {\n        e.preventDefault();\n        try {\n            const loginUser = { email, password };\n            const loginRes = await Axios.post(\n                '/api/users/login',\n                loginUser\n            );\n\n            setUserData({\n                token: loginRes.data.token,\n                user: loginRes.data.user\n            });\n\n            localStorage.setItem('auth-token', loginRes.data.token);\n            history.push('/');\n        } catch (err) {\n            (err.response.data.msg && setError(err.response.data.msg))\n        }\n\n    }\n\n    return (\n        <div className='page'>\n            <div className='container'>\n                <h2>Login</h2>\n                {error && (\n                    <ErrorNotice message={error} clearError={() => setError(undefined)} />\n                )}\n                <form className='form' onSubmit={submit}>\n                    <label htmlFor='login-email'>Email</label>\n                    <input\n                        id='login-email'\n                        type='email'\n                        onChange={e => setEmail(e.target.value)}\n                    />\n\n                    <label htmlFor='login-password'>Password</label>\n                    <input\n                        id='login-password'\n                        type='password'\n                        onChange={e => setPassword(e.target.value)}\n                    />\n\n                    <input type='submit' value='Log in' />\n\n                </form>\n            </div>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}