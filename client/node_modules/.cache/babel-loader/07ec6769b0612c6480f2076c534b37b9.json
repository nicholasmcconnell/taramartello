{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nicholasmcconnell/code/todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useContext,useState}from'react';import UserContext from'../../context/UserContext';import{useHistory,Link}from'react-router-dom';import ErrorNotice from'../misc/ErrorNotice';import API from'../../utils/todoAPI';import Card from'../layout/Card';export default function SearchTodos(){var _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),todoList=_useState4[0],setTodoList=_useState4[1];var _useState5=useState({search:undefined}),_useState6=_slicedToArray(_useState5,2),todoSearch=_useState6[0],setTodoSearch=_useState6[1];var _useContext=useContext(UserContext),userData=_useContext.userData;var history=useHistory();localStorage.setItem('lastVisited','searchtodos');useEffect(function(){if(!userData.user){history.push('/login');}});var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(todoSearch.search);_context.prev=1;e.preventDefault();setError(undefined);_context.next=6;return API.searchTodos(todoSearch.search,userData.token).then(function(res){if(res.data.length===0){setError('No matches!  Do you need more to-do...?');}else{setTodoList(res.data);}});case 6:_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.log(_context.t0);_context.t0.response.data.msg&&setError('No matches!  Do you need more to-do...?');case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function submit(_x){return _ref.apply(this,arguments);};}();var deleteTodos=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return API.deleteTodos(userData.token,id).then(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return API.getTodos(userData.token).then(function(res){setTodoList(res.data);}).catch(function(err){if(todoList.length>=1){setTodoList([]);err.response.data.msg&&setError(err.response.data.msg);}err.response.data.msg&&setError(err.response.data.msg);});case 2:case\"end\":return _context2.stop();}}},_callee2);}))).catch(function(err){return err.response.data.msg&&setError(err.response.data.msg);});case 3:_context3.next=8;break;case 5:_context3.prev=5;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,5]]);}));return function deleteTodos(_x2){return _ref2.apply(this,arguments);};}();var getTodos=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return API.getTodos(userData.token).then(function(res){setTodoList(res.data);}).catch(function(err){return err.response.data.msg&&setError(err.response.data.msg);});case 3:_context4.next=8;break;case 5:_context4.prev=5;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);case 8:case\"end\":return _context4.stop();}}},_callee4,null,[[0,5]]);}));return function getTodos(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Search Todos\"),error&&/*#__PURE__*/React.createElement(ErrorNotice,{message:error,clearError:function clearError(){return setError(undefined);}}),/*#__PURE__*/React.createElement(\"form\",{className:\"form\",onSubmit:submit},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"search-term\"},\"Search:\"),/*#__PURE__*/React.createElement(\"input\",{id:\"todo-search\",type:\"text\",placeholder:\"Search your todos\",onChange:function onChange(e){return setTodoSearch({search:e.target.value});}}),/*#__PURE__*/React.createElement(\"div\",{className:\"buttons-div\"},/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Submit\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"reset\",value:\"Clear\"// onClick={() => { setIntialStates();  window.location.reload(false); }}\n}))),/*#__PURE__*/React.createElement(\"div\",{className:\"card-container\"},todoList.length?todoList.map(function(todo){return/*#__PURE__*/React.createElement(Card,{id:todo._id,todoList:todo,key:todo._id,deleteTodos:deleteTodos,getTodos:getTodos});}):/*#__PURE__*/React.createElement(\"p\",null)),/*#__PURE__*/React.createElement(Link,{to:\"/\"},/*#__PURE__*/React.createElement(\"button\",{className:\"type-button\",value:\"Home\"},\"Home\"))));}","map":{"version":3,"sources":["/Users/nicholasmcconnell/code/todo/client/src/components/todo/SearchTodo.js"],"names":["React","useEffect","useContext","useState","UserContext","useHistory","Link","ErrorNotice","API","Card","SearchTodos","undefined","error","setError","todoList","setTodoList","search","todoSearch","setTodoSearch","userData","history","localStorage","setItem","user","push","submit","e","console","log","preventDefault","searchTodos","token","then","res","data","length","response","msg","deleteTodos","id","getTodos","catch","err","target","value","map","todo","_id"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from 'react';\nimport UserContext from '../../context/UserContext';\nimport { useHistory, Link } from 'react-router-dom';\nimport ErrorNotice from '../misc/ErrorNotice';\nimport API from '../../utils/todoAPI';\nimport Card from '../layout/Card';\n\nexport default function SearchTodos() {\n    const [error, setError] = useState(undefined);\n    const [todoList, setTodoList] = useState([]);\n    const [todoSearch, setTodoSearch] = useState({\n        search: undefined\n    });\n\n    const { userData } = useContext(UserContext);\n    const history = useHistory();\n\n    localStorage.setItem('lastVisited', 'searchtodos')\n\n\n    useEffect(() => {\n        if (!userData.user) {\n            history.push('/login')\n        }\n    });\n\n    const submit = async (e) => {\n        console.log(todoSearch.search)\n        try {\n            e.preventDefault();\n            setError(undefined)\n\n            await API.searchTodos(todoSearch.search, userData.token)\n                .then(res => {\n                    if (res.data.length === 0) {\n                        (setError('No matches!  Do you need more to-do...?'))\n                    } else {\n\n                        setTodoList(res.data)\n                    }\n                })\n        } catch (err) {\n            console.log(err)\n            err.response.data.msg && setError('No matches!  Do you need more to-do...?');\n        }\n    }\n\n    const deleteTodos = async (id) => {\n        try {\n            await API.deleteTodos(userData.token, id)\n                .then(async () => {\n                    await API.getTodos(userData.token)\n                        .then(res => {\n                            setTodoList(res.data)\n                        })\n                        .catch(err => {\n                            if (todoList.length >= 1) {\n                                setTodoList([]);\n                                (err.response.data.msg && setError(err.response.data.msg))\n                            }\n\n                            (err.response.data.msg && setError(err.response.data.msg))\n\n                        })\n                })\n                .catch(err =>\n                    (err.response.data.msg && setError(err.response.data.msg))\n                )\n        } catch (err) {\n            console.log(err)\n        }\n    }\n\n    const getTodos = async () => {\n        try {\n            await API.getTodos(userData.token)\n                .then(res => {\n                    setTodoList(res.data)\n                })\n                .catch(err =>\n                    (err.response.data.msg && setError(err.response.data.msg))\n                )\n        } catch (err) {\n            console.log(err)\n        }\n    }\n\n    return (\n\n        <div className='page'>\n            <div className='container'>\n\n                <h2>Search Todos</h2>\n\n                {error && (\n                    <ErrorNotice message={error} clearError={() => setError(undefined)} />\n                )}\n\n                <form className='form' onSubmit={submit}>\n                    <label htmlFor='search-term'>Search:</label>\n                    <input\n                        id='todo-search'\n                        type='text'\n                        placeholder='Search your todos'\n                        onChange={e => setTodoSearch({ search: e.target.value })}\n                    />\n                    <div className='buttons-div'>\n                        <input type='submit' value='Submit' />\n                        <input type='reset' value='Clear'\n                        // onClick={() => { setIntialStates();  window.location.reload(false); }}\n                        />\n                    </div>\n                </form>\n\n                <div className='card-container'>\n                    {todoList.length ? todoList.map(todo =>\n                        <Card\n                            id={todo._id}\n                            todoList={todo}\n                            key={todo._id}\n                            deleteTodos={deleteTodos}\n                            getTodos={getTodos}\n                        />\n\n                    ) :\n                        <p></p>\n\n                    }\n                </div>\n                <Link to='/'>\n                    <button className='type-button' value='Home'>Home</button>\n                </Link>\n            </div>\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}